---
layout: post
title: golang 学习笔记
---

[TOC]


# 基础语法

## 变量定义

### 1. 关键字**var** 

#### 定义

```golang
var a int
var b string
```

定义之后，自动赋予初始值 ZeroValue

`0` for numeric types,  
`false` for the boolean type, and  
`""` (the empty string) for strings.

#### 定义并初始化

```golang
var a, c int = 1, 2
var b string = "b"
```

类型可省略，编译器自动推断

```golang
var a, b, c, d = 1, 2, true, "hello world"
```

### 2. := 定义并初始化

在函数内部，可以使用`:=`替代`var`

```golang
func xxx(){
    k := 3
    c, python, java := true, false, "no!"
}
```

但是在函数外面，所有的语句必须以关键字开始（ `var`, `func`... ），不可使用`:=`

### 变量作用域

go没有全局变量，有包内变量，和函数内变量

## 内建变量类型

- `bool` `string`
-  `(u)int` `(u)int8` `(u)int16` `(u)int32` `(u)int64` `uintptr`
-  `byte` `rune`


# Goroutine
非抢占式 由协程自己在切换点交出cpu控制权

Goroutine 可能的切换点

- I/O, select
- channel
- 等待锁
- 函数调用(有时)
- runtime.Gosched()
- 等待锁



# 编码相关

## Code

```Golang
func TestRune(t *testing.T) {
	s := "12一二"
	t.Log(len(s))
	t.Log("------")
	for i, b := range []byte(s) { // utf8
		t.Logf("%d %x", i, b)
	}
	t.Log("------")
	for i, b := range s { // utf8 --> unicode
		t.Logf("%d %x", i, b)
	}
	t.Log("------")
	for i, b := range []rune(s) { // utf8 --> unicode --> []rune
		t.Logf("%d %x", i, b)
	}
}
```

## Output:

```
8
------
0 31
1 32
2 e4
3 b8
4 80
5 e4
6 ba
7 8c
------
0 31
1 32
2 4e00
5 4e8c
------
0 31
1 32
2 4e00
3 4e8c
```

## Ref

- [字符编码笔记：ASCII，Unicode 和 UTF-8](http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html)
